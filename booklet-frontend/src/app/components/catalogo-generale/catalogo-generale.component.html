<section class="section">

  <!-- Titolo + Burger in alto -->
  <div class="header-row">
    <h2>Catalogo Completo</h2>

    <button mat-icon-button (click)="drawer.toggle()" class="burger">
      <mat-icon>menu</mat-icon>
    </button>
  </div>

  <div *ngIf="caricamento" class="loading">Caricamento in corso...</div>

  <div *ngIf="!caricamento && errore" class="error">{{ errore }}</div>

  <div *ngIf="!caricamento && !errore && libriFiltrati.length === 0" class="empty">
    Nessun libro disponibile al momento.
  </div>

  <!-- Catalogo filtrato (UNICO) -->
  <div class="catalogo-container" *ngIf="!caricamento && !errore && libriFiltrati.length > 0">
    <app-libro-card
      *ngFor="let libro of libriPagina; trackBy: trackByIsbn"
      [libro]="libro">
    </app-libro-card>
  </div>

  <!-- Controlli di paginazione -->
  <div *ngIf="!caricamento && !errore && libriFiltrati.length > 0" class="pagination-controls">
    <button
      mat-raised-button
      (click)="paginaPrecedente()"
      [disabled]="paginaCorrente === 0"
      class="pagination-button">
      <mat-icon>chevron_left</mat-icon>
      Precedente
    </button>

    <span class="pagination-info">
      Pagina {{ paginaCorrente + 1 }} di {{ totalePagine }}
      ({{ libriFiltrati.length }} libri totali)
    </span>

    <button
      mat-raised-button
      (click)="paginaSuccessiva()"
      [disabled]="paginaCorrente >= totalePagine - 1"
      class="pagination-button">
      Successiva
      <mat-icon>chevron_right</mat-icon>
    </button>
  </div>

  <!-- üî• SEZIONE ADMIN (SPOSTATA QUI DENTRO = VISIBILE) -->
  <div *ngIf="ruoloAdmin" class="admin-panel" style="display:flex; gap:1rem; flex-wrap: wrap;">
    <button mat-raised-button color="primary" (click)="apriDialogAggiungiLibro()">
      ‚ûï Aggiungi libro
    </button>
    <button mat-raised-button color="accent" (click)="apriDialogModificaLibro()">
      ‚úèÔ∏è Modifica libro
    </button>
  </div>

  <div *ngIf="ruoloAdmin"
       class="admin-panel"
       style="margin-top: 1rem; display:flex; gap:1rem; align-items:center;">

    <mat-form-field appearance="outline">
      <mat-label>Rimuovi libro per ISBN</mat-label>
      <input matInput [(ngModel)]="isbnDaRimuovere">
    </mat-form-field>

    <button mat-raised-button color="warn" (click)="rimuoviLibro()">
      üóëÔ∏è Rimuovi
    </button>

  </div>

</section>


<!-- FILTRI (SIDENAV) -->
<mat-sidenav-container class="container">

  <mat-sidenav #drawer mode="over">
    <h3 class="title">Filtri</h3>

    <!-- filtro titolo -->
    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>Cerca titolo</mat-label>
      <input matInput [(ngModel)]="filtroTitolo" (input)="applicaFiltri()">
    </mat-form-field>

    <!-- filtro per genere -->
    <h4 class="subtitle">Genere</h4>
    <mat-selection-list [(ngModel)]="filtroGenere" (selectionChange)="applicaFiltri()">
      <mat-list-option *ngFor="let g of generi" [value]="g">
        {{ g }}
      </mat-list-option>
    </mat-selection-list>

    <!-- ordinamento -->
    <h4 class="subtitle">Ordina per</h4>
    <mat-radio-group [(ngModel)]="ordinamento" (change)="applicaFiltri()">
      <mat-radio-button value="titolo">Titolo (A‚ÜíZ)</mat-radio-button><br>
      <mat-radio-button value="prezzo">Prezzo (crescente)</mat-radio-button><br>
      <mat-radio-button value="prezzoDesc">Prezzo (decrescente)</mat-radio-button>
    </mat-radio-group>

  </mat-sidenav>

  <mat-sidenav-content></mat-sidenav-content>

</mat-sidenav-container>
